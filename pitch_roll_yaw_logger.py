import rtde_receive
import time
import numpy as np
from scipy.spatial.transform import Rotation as R

# Connect to UR5e
rtde_r = rtde_receive.RTDEReceiveInterface("192.168.1.5")  
while True:
    try:
        # Get current TCP pose
        tcp_pose = rtde_r.getActualTCPPose()
        #print(f"Current TCP Pose: {tcp_pose}")
        
        
       

        position = np.array(tcp_pose[:3])
        axis_angle = np.array(tcp_pose[3:])

        # Convert axis-angle to rotation matrix
        r = R.from_rotvec(axis_angle)
        rotation_matrix = r.as_matrix()

        # Or to quaternion
        quaternion = r.as_quat()  # [x, y, z, w]
        
        euler = r.as_euler('xyz', degrees=True)
        print("Roll, Pitch, Yaw:", euler)


        print(20 * "*")
        print()
        time.sleep(1)

    except KeyboardInterrupt:
        print("Exiting...")
        break

    except Exception as e:
        print(f"Error occurred: {e}")

print(f"Current TCP: {tcp_pose}")



#Supply tray
#1:
#home : [0.10972228217164283, -0.7699928537562144, 0.30663111188318837, -0.04194924413514414, -3.1231293616132754, -0.09293013121234954]
#cup: [0.11446719125224977, -0.7737674489324361, 0.19023239130118497, -0.09686180753642928, -3.106569082074735, -0.07778534783075176]


#2
#home: [0.0061390315183745894, -0.7603905034126006, 0.28041883784721167, 0.03116565368034904, -3.1272447891134316, 0.01845181213884488]
#cup: [0.005588702622883938, -0.7785119198247803, 0.19063939724902976, -0.03211928660416126, 3.1298922687079362, 0.11492911445236403]

#3
#home : [0.10988239263175058, -0.6662012735469999, 0.26837211709052267, -0.05602789868763588, -3.13736006570147, -0.006617218601905454]
#cup : [0.1019751393538642, -0.6717478804689248, 0.19123708812543821, 0.1039856544391666, -3.1176139144068324, -0.11882732864941109]

#4
#home : [0.007705460210910838, -0.6684276478759643, 0.26562187297504514, -0.017810669821759464, -3.1253823293063863, -0.015470474163351672]
#cup : [0.008725052018221524, -0.6750321651949683, 0.1887378849037341, -0.02563004653914515, -3.112075470269463, -0.06053646034654946]




#Deposit Tray


#1:
#home : [0.6110898589601272, -0.448011045199247, 0.24724448094717574, -2.2733780579994565, 2.152600284923447, -0.050243955144804085]
#cup: [0.615152553280938, -0.4488069986144266, 0.17962281224537416, -2.272336024331266, 2.1481474162928476, 0.08606986710287223]


#2
#home: [0.6175360632423563, -0.5360545728839707, 0.24908553564616212, 2.2475729856036746, -2.1601985337513843, 0.12085570533752739]
#cup: [0.6233152161732488, -0.54366567483447, 0.17754301523701801, 2.254161166912795, -2.1677485107670664, 0.011466108040206015]
